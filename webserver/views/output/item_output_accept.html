{{define "output/item_output_accept"}}
{{template "header" .}}

<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>

<div class="main-page" style="display: none;">
    <!-- <div class="main-bg"></div>
    <div class="main-con"></div> -->
</div>

<div>
    <div>
        택배를 꺼내 주세요.
    </div>
    <div>
        5초 뒤 자동으로 재입고 됩니다.
    </div>
    <div id="$counter">
        5
    </div>
</div>

<script>
    const url = new URL(window.location.href);
    const itemId = url.searchParams.get("itemId");
    const timeLimit = 3;

    let counter = 0;
    let intervalId = setInterval(() => {
        // TODO - 출고 확인
        counter += 1;
        $counter.innerText = timeLimit - counter;


        console.log('hello');

        if (counter === timeLimit) {
            // TODO - 반환
            clearInterval(intervalId);
            axios.post('/output/return?itemId=' + itemId)
                .then(axiosResult => {
                    let response = axiosResult.data;
                    console.log(response);
                })
                .catch(err => {
                    console.error(err);
                });
        }
    }, 1000)

    $submit_btn.onclick = () => {
        axios.post('/output/password/check', {
            item_id: parseInt(itemId),
            password: parseInt($password_input.value),
        })
        .then(axiosResult => {
            let response = axiosResult.data;
            console.log(response);
        })
        .catch(err => {
            alert('비밀번호가 올바르지 않습니다.');
            console.error(err);
        })
    }

    $cancel_btn.onclick = () => {
        axios.post('/output/item_output_return')
            .then(axiosResult => {
                let response = axiosResult.data;
                console.log(response);
            })
            .cache(err => {
                console.error(err);
            })
        window.location.replace('')
    }
</script>
{{end}}